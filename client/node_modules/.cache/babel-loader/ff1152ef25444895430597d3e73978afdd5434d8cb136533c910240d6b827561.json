{"ast":null,"code":"var _jsxFileName = \"/Users/junmao/Desktop/CSE316_HW/project-thomaschuchu/client/src/components/communityPage.js\";\nimport React from 'react';\nimport { PostSection, InfoSection, getTotalComments, getCommunity, ButtonDisplay, orderNewest } from './homePage.js';\nimport '../stylesheets/communityPage.css';\nimport axios from 'axios';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default class TheCommunityPage extends React.Component {\n  constructor(props) {\n    super(props);\n    this.setMemberCount = count => {\n      this.setState({\n        memberCount: count\n      });\n    };\n    this.state = {\n      order: orderNewest,\n      isMember: false,\n      memberCount: null\n    };\n    this.updateOrder = this.updateOrder.bind(this);\n    this.handleJoinLeave = this.handleJoinLeave.bind(this);\n  }\n  sortCommunitiesByMembership(user, communities, setCommunities) {\n    // return communities.sort((a, b) => {\n    //   const aIsMember = a.members.includes(user);\n    //   const bIsMember = b.members.includes(user);\n\n    //   // Prioritize communities the user has joined\n    //   if (aIsMember && !bIsMember) return -1; // a should come first\n    //   if (!aIsMember && bIsMember) return 1;  // b should come first\n    //   return a.name.localeCompare(b.name);  // Sort alphabetically if both are same status\n    // });\n    const sortedCommunities = [...communities].sort((a, b) => {\n      const aIsMember = a.members.includes(user);\n      const bIsMember = b.members.includes(user);\n\n      // Prioritize communities the user has joined\n      if (aIsMember && !bIsMember) return -1; // a should come first\n      if (!aIsMember && bIsMember) return 1; // b should come first\n      return a.name.localeCompare(b.name); // Sort alphabetically if both are same status\n    });\n    return sortedCommunities;\n  }\n  async handleJoinLeave(goToCommunityPage) {\n    const {\n      community,\n      communities\n    } = this.props;\n    const comName = communities.find(com => com.name === community);\n    //const currentCommunity = communities.find((com) => com.name === community);\n    const {\n      isMember\n    } = this.state;\n    if (isMember) {\n      // Handle leaving the community\n      try {\n        await axios.post(`http://localhost:8000/leaveCommunity`, {\n          communityId: comName._id\n        }, {\n          withCredentials: true\n        });\n        this.setState({\n          isMember: false\n        });\n        alert('You have left the community.');\n      } catch (error) {\n        console.error('Error leaving community:', error);\n        alert('Failed to leave the community. Please try again.');\n      }\n    } else {\n      // Handle joining the community\n      try {\n        await axios.post(`http://localhost:8000/joinCommunity`, {\n          communityId: comName._id\n        }, {\n          withCredentials: true\n        });\n        this.setState({\n          isMember: true\n        });\n        alert('You have joined the community.');\n      } catch (error) {\n        console.error('Error joining community:', error);\n        alert('Failed to join the community. Please try again.');\n      }\n    }\n    goToCommunityPage(comName.name);\n    // const displayName = loggedIn ? userInfo[0] : \"Guest\";\n    // let sortedCommunities = this.sortCommunitiesByMembership(displayName, this.props.communities, setCommunities);\n    // setCommunities(sortedCommunities);\n  }\n  async componentDidMount() {\n    const {\n      community,\n      communities,\n      loggedIn,\n      userInfo\n    } = this.props;\n    console.log(community);\n    const comName = communities.find(com => com.name === community);\n    console.log(comName);\n    if (loggedIn) {\n      const displayName = userInfo[0];\n      const comID = comName._id;\n      try {\n        const response = await axios.get(`http://localhost:8000/checkMembership`, {\n          params: {\n            communityId: comID,\n            displayName: displayName\n          },\n          withCredentials: true\n        });\n        console.log(\"IS IT A MEMBER?\", response.data);\n        this.setState({\n          isMember: response.data.isMember\n        });\n      } catch (error) {\n        console.error('Error checking membership:', error);\n      }\n    }\n  }\n  async componentDidUpdate(prevProps) {\n    console.log(\"THIS IS PREV PROPS\", prevProps);\n    const {\n      community,\n      communities,\n      loggedIn,\n      userInfo\n    } = this.props;\n    console.log(community);\n    //const comName = communities.find((com) => com.name === community);\n    //console.log(comName)\n    if (community !== prevProps.community) {\n      const comName = communities.find(com => com.name === community);\n      if (loggedIn) {\n        const displayName = userInfo[0];\n        const comID = comName._id;\n        try {\n          const response = await axios.get(`http://localhost:8000/checkMembership`, {\n            params: {\n              communityId: comID,\n              displayName: displayName\n            },\n            withCredentials: true\n          });\n          console.log(\"IS IT A MEMBER?\", response.data);\n          this.setState({\n            isMember: response.data.isMember\n          });\n        } catch (error) {\n          console.error('Error checking membership:', error);\n        }\n      }\n    }\n  }\n  updateOrder(newOrder) {\n    //console.log(\"UPDATING ORDER\");\n    this.setState({\n      order: newOrder\n    });\n  }\n  render() {\n    const {\n      community,\n      communities,\n      posts,\n      comments,\n      linkFlairs,\n      goToPostPage,\n      handleOrderButtonClick,\n      loggedIn,\n      userInfo,\n      setCommunities,\n      setPage,\n      goToCommunityPage\n    } = this.props;\n    //const { isMember } = this.state;\n    const {\n      isMember,\n      memberCount\n    } = this.state;\n    console.log(\"COMMUNITY PROPS\", this.props);\n    //console.log(comName);\n    console.log(\"am i logggggged in?\", loggedIn);\n    const filtered = filterPosts('community', community, posts, communities, comments);\n    //console.log(\"FILTERED POSTS\", filtered)\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      id: \"homePage\",\n      className: \"main_cont_divs\",\n      children: [/*#__PURE__*/_jsxDEV(CommunityPageHeader, {\n        comName: community,\n        communities: communities,\n        handleOrderButtonClick: handleOrderButtonClick,\n        updateOrder: this.updateOrder,\n        loggedIn: loggedIn,\n        userInfo: userInfo,\n        memberCount: memberCount,\n        setMemberCount: this.setMemberCount\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 138,\n        columnNumber: 11\n      }, this), loggedIn && /*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"communityActions\",\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => this.handleJoinLeave(goToCommunityPage, memberCount, set),\n          className: \"joinLeaveButton\",\n          children: isMember ? 'Leave Community' : 'Join Community'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 151,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 150,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(PostSection, {\n        page: 'community',\n        posts: filtered,\n        comments: comments,\n        linkFlairs: linkFlairs,\n        communities: communities,\n        order: this.state.order,\n        goToPostPage: goToPostPage,\n        loggedIn: loggedIn,\n        userInfo: userInfo\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 156,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 9\n    }, this);\n  }\n}\nclass CommunityPageHeader extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      memberCount: null,\n      createdBy: ''\n    };\n  }\n  async fetchMemberCount(community) {\n    try {\n      const response = await axios.get(`http://localhost:8000/communityInformation/${community._id}`);\n      console.log(response.data);\n      this.setState({\n        memberCount: response.data.memberCount,\n        createdBy: response.data.createdBy\n      }); // Assuming response.data is the member count\n    } catch (error) {\n      console.log(\"No community found\");\n    }\n  }\n  componentDidMount() {\n    const {\n      communities,\n      comName\n    } = this.props;\n    const community = communities.find(community => community.name === comName);\n    if (community) {\n      this.fetchMemberCount(community);\n    }\n  }\n  componentDidUpdate(prevProps) {\n    const {\n      communities,\n      comName\n    } = this.props;\n    if (comName !== prevProps.comName) {\n      const community = communities.find(community => community.name === comName);\n      if (community) {\n        this.fetchMemberCount(community);\n      }\n    }\n  }\n  render() {\n    const {\n      communities,\n      comName,\n      updateOrder,\n      handleOrderButtonClick\n    } = this.props;\n    const community = communities.find(community => community.name === comName);\n    if (!community) return null;\n    const {\n      memberCount,\n      createdBy\n    } = this.state;\n    const startDate = community.startDate;\n    const comPostCount = community.postIDs.length;\n    console.log(\"logggggedin???????\", this.props.loggedIn);\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      id: \"header\",\n      children: [/*#__PURE__*/_jsxDEV(InfoSection, {\n        page: 'community',\n        startDate: startDate,\n        comName: comName,\n        memberCount: memberCount // Using memberCount from state\n        ,\n        setMemberCount: this.setMemberCount,\n        createdBy: createdBy,\n        description: community.description,\n        comPostCount: comPostCount,\n        loggedIn: this.props.loggedIn,\n        userInfo: this.props.userInfo\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 224,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(ButtonDisplay, {\n        handleOrderButtonClick: handleOrderButtonClick,\n        updateOrder: updateOrder\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 236,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 223,\n      columnNumber: 7\n    }, this);\n  }\n}\nexport function filterPosts(page, comName, posts, communities, comments) {\n  //console.log(\"CHECKING THE POSTS\", posts);\n  let filter = [...posts];\n  //console.log(filter);\n  if (page === \"community\") {\n    filter = filter.filter(function (element) {\n      // console.log(\"ELEMENT\", element);\n      // console.log(getCommunity(element._id, communities));\n      return getCommunity(element._id, communities) === comName;\n    });\n  }\n  if (page === \"search\") {\n    filter = new Set();\n    for (let i = 0; i < comName.length; i++) {\n      for (let j = 0; j < posts.length; j++) {\n        let commentArray = getTotalComments(posts[j], comments);\n        for (const x of commentArray) {\n          if (x.content.toLowerCase().includes(comName[i])) {\n            filter.add(posts[j]);\n          }\n        }\n        if (posts[j].title.toLowerCase().includes(comName[i])) {\n          filter.add(posts[j]);\n        } else if (posts[j].content.toLowerCase().includes(comName[i])) {\n          filter.add(posts[j]);\n        }\n      }\n    }\n  }\n  //console.log(filter);\n  return filter;\n}","map":{"version":3,"names":["React","PostSection","InfoSection","getTotalComments","getCommunity","ButtonDisplay","orderNewest","axios","jsxDEV","_jsxDEV","TheCommunityPage","Component","constructor","props","setMemberCount","count","setState","memberCount","state","order","isMember","updateOrder","bind","handleJoinLeave","sortCommunitiesByMembership","user","communities","setCommunities","sortedCommunities","sort","a","b","aIsMember","members","includes","bIsMember","name","localeCompare","goToCommunityPage","community","comName","find","com","post","communityId","_id","withCredentials","alert","error","console","componentDidMount","loggedIn","userInfo","log","displayName","comID","response","get","params","data","componentDidUpdate","prevProps","newOrder","render","posts","comments","linkFlairs","goToPostPage","handleOrderButtonClick","setPage","filtered","filterPosts","id","className","children","CommunityPageHeader","fileName","_jsxFileName","lineNumber","columnNumber","onClick","set","page","createdBy","fetchMemberCount","startDate","comPostCount","postIDs","length","description","filter","element","Set","i","j","commentArray","x","content","toLowerCase","add","title"],"sources":["/Users/junmao/Desktop/CSE316_HW/project-thomaschuchu/client/src/components/communityPage.js"],"sourcesContent":["import React from 'react';\nimport {PostSection, InfoSection, getTotalComments, getCommunity, ButtonDisplay, orderNewest} from './homePage.js';\nimport '../stylesheets/communityPage.css'\nimport axios from 'axios';\n\n\nexport default class TheCommunityPage extends React.Component{\n    constructor(props){\n      super(props);\n      this.state = {\n        order: orderNewest,\n        isMember: false,\n        memberCount: null,\n      };\n\n      this.updateOrder = this.updateOrder.bind(this);\n      this.handleJoinLeave = this.handleJoinLeave.bind(this);\n    }\n\n    sortCommunitiesByMembership(user, communities, setCommunities) {\n      // return communities.sort((a, b) => {\n      //   const aIsMember = a.members.includes(user);\n      //   const bIsMember = b.members.includes(user);\n\n      //   // Prioritize communities the user has joined\n      //   if (aIsMember && !bIsMember) return -1; // a should come first\n      //   if (!aIsMember && bIsMember) return 1;  // b should come first\n      //   return a.name.localeCompare(b.name);  // Sort alphabetically if both are same status\n      // });\n      const sortedCommunities = [...communities].sort((a, b) => {\n        const aIsMember = a.members.includes(user);\n        const bIsMember = b.members.includes(user);\n\n        // Prioritize communities the user has joined\n        if (aIsMember && !bIsMember) return -1; // a should come first\n        if (!aIsMember && bIsMember) return 1;  // b should come first\n        return a.name.localeCompare(b.name);  // Sort alphabetically if both are same status\n      });\n      return sortedCommunities;\n    }\n\n    async handleJoinLeave(goToCommunityPage) {\n      const { community, communities } = this.props;\n      const comName = communities.find((com) => com.name === community);\n      //const currentCommunity = communities.find((com) => com.name === community);\n      const { isMember } = this.state;\n  \n      if (isMember) {\n        // Handle leaving the community\n        try {\n          await axios.post(`http://localhost:8000/leaveCommunity`, { communityId: comName._id }, { withCredentials: true });\n          this.setState({ isMember: false });\n          alert('You have left the community.');\n        } catch (error) {\n          console.error('Error leaving community:', error);\n          alert('Failed to leave the community. Please try again.');\n        }\n      } else {\n        // Handle joining the community\n        try {\n          await axios.post(`http://localhost:8000/joinCommunity`, { communityId: comName._id }, { withCredentials: true });\n          this.setState({ isMember: true });\n          alert('You have joined the community.');\n        } catch (error) {\n          console.error('Error joining community:', error);\n          alert('Failed to join the community. Please try again.');\n        }\n      }\n      \n      goToCommunityPage(comName.name);\n      // const displayName = loggedIn ? userInfo[0] : \"Guest\";\n      // let sortedCommunities = this.sortCommunitiesByMembership(displayName, this.props.communities, setCommunities);\n      // setCommunities(sortedCommunities);\n    }\n\n    async componentDidMount() {\n      const { community, communities, loggedIn, userInfo } = this.props;\n      console.log(community);\n      const comName = communities.find((com) => com.name === community);\n      console.log(comName)\n      if (loggedIn) {\n        const displayName = userInfo[0];\n        const comID = comName._id\n        try {\n          const response = await axios.get(`http://localhost:8000/checkMembership`, {\n            params: { communityId: comID, displayName: displayName }, withCredentials: true,});\n          console.log(\"IS IT A MEMBER?\", response.data)\n          this.setState({ isMember: response.data.isMember });\n        } catch (error) {\n          console.error('Error checking membership:', error);\n        }\n      }\n    }\n\n    async componentDidUpdate(prevProps) {\n      console.log(\"THIS IS PREV PROPS\", prevProps)\n      const { community, communities, loggedIn, userInfo } = this.props;\n      console.log(community);\n      //const comName = communities.find((com) => com.name === community);\n      //console.log(comName)\n      if (community !== prevProps.community) {\n        const comName = communities.find((com) => com.name === community);\n        if (loggedIn) {\n          const displayName = userInfo[0];\n          const comID = comName._id\n          try {\n            const response = await axios.get(`http://localhost:8000/checkMembership`, {\n              params: { communityId: comID, displayName: displayName }, withCredentials: true,});\n            console.log(\"IS IT A MEMBER?\", response.data)\n            this.setState({ isMember: response.data.isMember });\n          } catch (error) {\n            console.error('Error checking membership:', error);\n          }\n        }\n      }\n    }\n\n    updateOrder(newOrder){\n      //console.log(\"UPDATING ORDER\");\n      this.setState({order: newOrder})\n    }\n\n    setMemberCount = (count) => {\n      this.setState({ memberCount: count });\n    }\n\n    render(){\n      const {community, communities, posts, comments, linkFlairs, goToPostPage, handleOrderButtonClick, loggedIn, userInfo, setCommunities, setPage, goToCommunityPage} = this.props;\n      //const { isMember } = this.state;\n      const { isMember, memberCount } = this.state;\n      console.log(\"COMMUNITY PROPS\", this.props);\n      //console.log(comName);\n      console.log(\"am i logggggged in?\", loggedIn);\n      const filtered = filterPosts('community', community, posts, communities, comments);\n      //console.log(\"FILTERED POSTS\", filtered)\n      return(\n        <div id=\"homePage\" className=\"main_cont_divs\">\n          <CommunityPageHeader \n            comName={community} \n            communities={communities} \n            handleOrderButtonClick={handleOrderButtonClick} \n            updateOrder={this.updateOrder}\n            loggedIn={loggedIn}\n            userInfo={userInfo}\n            memberCount={memberCount}\n            setMemberCount={this.setMemberCount}\n          />\n\n          {loggedIn && (\n          <div id=\"communityActions\">\n            <button onClick={() => this.handleJoinLeave(goToCommunityPage, memberCount, set)} className=\"joinLeaveButton\">\n              {isMember ? 'Leave Community' : 'Join Community'}\n            </button>\n          </div>\n          )}\n          <PostSection \n            page={'community'} \n            posts={filtered} \n            comments={comments} \n            linkFlairs={linkFlairs} \n            communities={communities} \n            order={this.state.order} \n            goToPostPage={goToPostPage}\n            loggedIn={loggedIn}\n            userInfo={userInfo}\n          />\n        </div>\n      );\n    }\n}\n\nclass CommunityPageHeader extends React.Component {\n  constructor(props) {\n      super(props);\n      this.state = {\n        memberCount: null,\n        createdBy: ''\n      };\n  }\n\n  async fetchMemberCount(community) {\n    try {\n      const response = await axios.get(`http://localhost:8000/communityInformation/${community._id}`);\n      console.log(response.data)\n      this.setState({ memberCount: response.data.memberCount,\n        createdBy: response.data.createdBy\n       }); // Assuming response.data is the member count\n    } catch (error) {\n      console.log(\"No community found\");\n    }\n  }\n\n  componentDidMount() {\n    const { communities, comName } = this.props;\n    const community = communities.find((community) => community.name === comName);\n\n    if (community) {\n      this.fetchMemberCount(community);\n    }\n  }\n\n  componentDidUpdate(prevProps) {\n    const { communities, comName } = this.props;\n    if (comName !== prevProps.comName) {\n      const community = communities.find((community) => community.name === comName);\n      if (community) {\n        this.fetchMemberCount(community);\n      }\n    }\n  }\n\n  render() {\n    const { communities, comName, updateOrder, handleOrderButtonClick  } = this.props;\n    const community = communities.find((community) => community.name === comName);\n\n    if (!community) return null;\n\n    const { memberCount, createdBy } = this.state;\n    const startDate = community.startDate;\n    const comPostCount = community.postIDs.length;\n    console.log(\"logggggedin???????\", this.props.loggedIn);\n    return (\n      <div id=\"header\">\n        <InfoSection \n          page={'community'}\n          startDate={startDate}\n          comName={comName}\n          memberCount={memberCount} // Using memberCount from state\n          setMemberCount={this.setMemberCount}\n          createdBy={createdBy}\n          description={community.description}\n          comPostCount={comPostCount}\n          loggedIn={this.props.loggedIn}\n          userInfo={this.props.userInfo}\n        />\n        <ButtonDisplay handleOrderButtonClick={handleOrderButtonClick} updateOrder={updateOrder} />\n      </div>\n    );\n  }\n}\n\n\nexport function filterPosts(page, comName, posts, communities, comments){\n  //console.log(\"CHECKING THE POSTS\", posts);\n  let filter = [...posts];\n  //console.log(filter);\n  if(page === \"community\"){\n    filter = filter.filter(function(element){\n      // console.log(\"ELEMENT\", element);\n      // console.log(getCommunity(element._id, communities));\n      return getCommunity(element._id, communities) === comName;\n    });\n  }\n\n  if(page === \"search\"){\n    filter = new Set();\n    \n    for(let i = 0; i < comName.length; i++){\n      for(let j = 0; j < posts.length; j++){ \n        let commentArray = getTotalComments(posts[j], comments);\n        for(const x of commentArray){\n          if(x.content.toLowerCase().includes(comName[i])){\n            filter.add(posts[j]);\n          }\n        }\n        \n        if(posts[j].title.toLowerCase().includes(comName[i])){\n          filter.add(posts[j]);\n        }\n        else if(posts[j].content.toLowerCase().includes(comName[i])){\n          filter.add(posts[j]);\n        }\n      }\n    }\n  }\n  //console.log(filter);\n  return filter;\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}